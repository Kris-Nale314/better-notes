<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600">
  <!-- Background -->
  <rect width="900" height="600" fill="#f8fafc" rx="5"/>
  
  <!-- Title -->
  <text x="450" y="40" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="24" fill="#1e293b">Better-Notes Comprehensive Data Flow</text>
  
  <!-- Document Input Section -->
  <rect x="50" y="100" width="150" height="80" rx="5" fill="#e0f2fe" stroke="#0ea5e9" stroke-width="2"/>
  <text x="125" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="16" fill="#0c4a6e">Document Upload</text>
  
  <!-- Macro-Chunking Section -->
  <rect x="50" y="220" width="150" height="80" rx="5" fill="#e0f2fe" stroke="#0ea5e9" stroke-width="2"/>
  <text x="125" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="16" fill="#0c4a6e">Macro-Chunking</text>
  <text x="125" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#0c4a6e">(10k tokens)</text>
  
  <!-- Config Selection Section -->
  <rect x="50" y="340" width="150" height="80" rx="5" fill="#fff7ed" stroke="#ea580c" stroke-width="2"/>
  <text x="125" y="375" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="16" fill="#9a3412">Config Selection</text>
  <text x="125" y="395" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#9a3412">(Issues, Actions, etc.)</text>
  
  <!-- User Context Section -->
  <rect x="50" y="460" width="150" height="80" rx="5" fill="#fdf4ff" stroke="#c026d3" stroke-width="2"/>
  <text x="125" y="495" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="16" fill="#86198f">User Context</text>
  <text x="125" y="515" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#86198f">(Instructions, Preferences)</text>
  
  <!-- Flow arrows to planner -->
  <line x1="200" y1="140" x2="275" y2="250" stroke="#64748b" stroke-width="2"/>
  <polygon points="270,245 275,250 265,250" fill="#64748b"/>
  
  <line x1="200" y1="260" x2="275" y2="260" stroke="#64748b" stroke-width="2"/>
  <polygon points="270,255 275,260 270,265" fill="#64748b"/>
  
  <line x1="200" y1="380" x2="275" y2="270" stroke="#64748b" stroke-width="2"/>
  <polygon points="270,275 275,270 267,265" fill="#64748b"/>
  
  <line x1="200" y1="500" x2="275" y2="290" stroke="#64748b" stroke-width="2"/>
  <polygon points="270,295 275,290 265,285" fill="#64748b"/>
  
  <!-- Planner Agent Section -->
  <rect x="275" y="200" width="200" height="120" rx="8" fill="#fef3c7" stroke="#d97706" stroke-width="3"/>
  <text x="375" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="18" fill="#92400e">Planner Agent</text>
  
  <rect x="295" y="235" width="160" height="20" rx="3" fill="#fef9c3" stroke="#a16207" stroke-width="1"/>
  <text x="375" y="250" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#854d0e">Analysis Strategy Design</text>
  
  <rect x="295" y="260" width="160" height="20" rx="3" fill="#fef9c3" stroke="#a16207" stroke-width="1"/>
  <text x="375" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#854d0e">Agent Selection</text>
  
  <rect x="295" y="285" width="160" height="20" rx="3" fill="#fef9c3" stroke="#a16207" stroke-width="1"/>
  <text x="375" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#854d0e">Task Definition</text>
  
  <!-- Assessment Crew Section (outer frame) -->
  <rect x="530" y="120" width="320" height="280" rx="8" fill="#f8fafc" stroke="#64748b" stroke-width="2" stroke-dasharray="5,3"/>
  <text x="690" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="18" fill="#475569">Assessment Crew</text>
  
  <!-- Generic Agents inside crew -->
  <circle cx="590" cy="200" r="40" fill="#dcfce7" stroke="#059669" stroke-width="2"/>
  <text x="590" cy="200" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="14" fill="#065f46">Extractor</text>
  <text x="590" cy="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#065f46">Agent</text>
  
  <circle cx="690" cy="200" r="40" fill="#dbeafe" stroke="#2563eb" stroke-width="2"/>
  <text x="690" cy="200" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="14" fill="#1e40af">Aggregator</text>
  <text x="690" cy="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#1e40af">Agent</text>
  
  <circle cx="790" cy="200" r="40" fill="#f3e8ff" stroke="#7c3aed" stroke-width="2"/>
  <text x="790" cy="200" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="14" fill="#5b21b6">Evaluator</text>
  <text x="790" cy="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#5b21b6">Agent</text>
  
  <circle cx="590" cy="320" r="40" fill="#fee2e2" stroke="#dc2626" stroke-width="2"/>
  <text x="590" cy="320" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="14" fill="#991b1b">Formatter</text>
  <text x="590" cy="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#991b1b">Agent</text>
  
  <circle cx="790" cy="320" r="40" fill="#fae8ff" stroke="#c026d3" stroke-width="2"/>
  <text x="790" cy="320" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="14" fill="#86198f">Reviewer</text>
  <text x="790" cy="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#86198f">Agent</text>
  
  <!-- Connection lines inside crew -->
  <line x1="630" y1="200" x2="650" y2="200" stroke="#64748b" stroke-width="1.5"/>
  <line x1="730" y1="200" x2="750" y2="200" stroke="#64748b" stroke-width="1.5"/>
  <line x1="790" y1="240" x2="790" y2="280" stroke="#64748b" stroke-width="1.5"/>
  <line x1="630" y1="320" x2="750" y2="320" stroke="#64748b" stroke-width="1.5"/>
  <path d="M 590 240 C 590 260, 590 280, 590 280" fill="none" stroke="#64748b" stroke-width="1.5"/>
  <path d="M 690 240 C 690 280, 630 320, 630 320" fill="none" stroke="#64748b" stroke-width="1.5"/>
  <path d="M 750 200 C 850 200, 850 320, 830 320" fill="none" stroke="#64748b" stroke-width="1.5" stroke-dasharray="5,3"/>
  
  <!-- Flow from Planner to Assessment Crew -->
  <path d="M 475 260 C 500 260, 510 260, 530 260" fill="none" stroke="#64748b" stroke-width="3"/>
  <polygon points="525,255 530,260 525,265" fill="#64748b"/>
  
  <!-- Assessment Report Section -->
  <rect x="530" y="460" width="320" height="100" rx="8" fill="#f1f5f9" stroke="#475569" stroke-width="2.5"/>
  <text x="690" y="490" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" font-size="18" fill="#334155">Assessment Report</text>
  <text x="690" y="520" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#334155">Output with Metadata</text>
  <text x="690" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#334155">+ Interactive Chat Interface</text>
  
  <!-- Flow from Assessment Crew to Report -->
  <path d="M 690 400 C 690 420, 690 430, 690 460" fill="none" stroke="#64748b" stroke-width="3"/>
  <polygon points="695,455 690,460 685,455" fill="#64748b"/>
  
  <!-- Legend Section -->
  <rect x="50" y="560" width="800" height="30" rx="4" fill="#f1f5f9" stroke="none"/>
  <text x="450" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#475569">Data Flow Direction</text>
  <line x1="580" y1="580" x2="620" y2="580" stroke="#64748b" stroke-width="2"/>
  <polygon points="615,575 620,580 615,585" fill="#64748b"/>
  
  <text x="670" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#475569">Optional Path</text>
  <line x1="730" y1="580" x2="770" y2="580" stroke="#64748b" stroke-width="2" stroke-dasharray="5,3"/>
  <polygon points="765,575 770,580 765,585" fill="#64748b"/>
</svg>